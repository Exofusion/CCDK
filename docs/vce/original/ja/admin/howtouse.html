<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" href="../../vce.css" type="text/css">
<title>VCE #VER# official document</title> 
</head>

<body>

<h1>Admcli 使いかた</h1>

<h2> 目次</h2>
<ul>
  <li><a href="#hostwnd">ホストウィンドウ</a> </li>
  <li><a href="#procwnd">プロセスウィンドウ</a> </li>
  <li><a href="#srhwnd">ログ検索ウィンドウ </a></li>
  <li><a href="#chat">チャット関連 </a></li>
  <li><a href="#otherwindows">その他のウィンドウ </a></li>
  <li><a href="#config">設定</a></li>
</ul>

      
<a name="hostwnd"></a>      
<h2>ホストウィンドウ</h2>
<p><img src="host_window.png" width="679" height="159"></p>
<p>      
このウィンドウは、ホストの状態を表示する。<br>
各項目の見出し列をクリックする事で、その項目でソートする事が出来き、
また、各行は複数選択が可能で、一部コマンド以外は複数行を同時に選択して実行する事が出来る。</p>
      
<h3>各項目の説明</h3>
<ul> 
  <li>Alert
    <p>設定した条件を満たした時に「！」マークが出現し、注意を促す。</p></li>
  <li>Id
    <p>admsv がホスト毎に与えた一意のID番号。</p></li>
  <li>Addr
    <p>ホストのIPアドレス。</p></li>
  <li>Name
    <p>ホスト名。</p></li>
  <li>Tag
    <p>管理用Tag。admsv 設定ファイル又はクライアントから自由に設定出来る。
      管理しやすいように、それぞれ指定する。</p></li>
  <li>State
    <p>ホストの状態を表す。DEAD,INIT,ALIVE の３つの状態があり、DEAD,INIT の場合は行が赤く表示される。<br>
    DEAD : rsvへのコネクションが張れない(rsvが動いていないか、ネットワークが切断している) <br>
    INIT : rsvへのコネクションは張れているが、pingが帰って来ない(rsvが起動しているが、止まっている)<br>
    ALIVE : rsvが正常に稼働している。
  </p></li>
  <li>LoadAvr
    <p>ホストのロードアベレージ。1000 倍した値が表示されている。</p></li>
  <li>LoadAvr グラフ
    <p>ロードアベレージのグラフ。[ツール]-[設定]-[グラフ] で カスタマイズが可能ある。</p></li>
  <li>Ping
    <p>ホストとのping値。単位はミリ秒。</p></li>
  <li>Ping グラフ
    <p>Pingのグラフ。[ツール]-[設定]-[グラフ] で カスタマイズ可能である。</p></li>
</ul>


<h3>ホストウィンドウの操作</h3>
<p>ホストウィンドウでは、以下の操作を行う事が出来る。
ホストウィンドウの操作は、ウィンドウメニューの[ホスト]から、またはホストウィンドウ上で右クリックする事によって現れるメニューから行う。</p>
<ul> 
  <li>ウィンドウの自動更新の切り替え
    <p>ウィンドウ情報の自動更新のOn/Offを切り替える。</p></li>
  <li>ウィンドウの更新
    <p>ウィンドウ情報を更新する。</p></li>
  <li>コマンド実行
    <p>UNIXコマンドを実行する。ホストで実行されている rsv がコマンドを受取り、実行する。コマンド結果は結果ウィンドウに出力される。</p></li>
  <li>タグの編集
    <p>ホストのTAGの編集をする。権限制限がある。</p></li>
  <li>ホストの作成
    <p>新しくホストを追加する。追加するホストのIPアドレス、Tagを指定する。権限制限がある。</p></li>
  <li>ホストの削除
    <p>ホストを削除する。権限制限あり。</p></li>
</ul>
      
<a name="procwnd"></a>
<h2>プロセスウィンドウ</h2>
<p><img src="process_window.png" width="931" height="315"></p>
<p>
このウィンドウは、各ホスト上で動作している <a href="../monitor.html">VCE monitor API</a> によって管理する事の出来るプロセス群の状態を表示している。
各項目の見出し列をクリックする事で、その項目でソートする事が出き、
また、各行は複数選択が可能で、一部コマンド以外は複数行を同時に選択して実行する事が出きる。</p>

<h3>各項目の説明</h3>
<ul> 
  <li>Alert
    <p>設定した条件を満たした時に「！」マークが出現し、注意を促す。</p></li>
  <li>PID
    <p>プロセスのUNIXプロセスID(psコマンドで表示されるもの) </p></li>
  <li>Id
    <p>admsv がプロセス毎に与えた一意のID番号。ログ検索などで、対象プロセスの指定識別子として使用する。</p></li>
  <li>Addr
    <p>プロセスが動作しているホストのIPアドレス</p></li>
  <li>Name
    <p>プロセスの名前。
    'get_name'モニターコマンドで返された名前である。
    サーバーを識別するための名前を返すようアプリケーションを作るとよいであろう。</p></li>
  <li>Tag
    <p>管理用Tag。admsv 設定ファイル又はクライアントから自由に設定出来る。</p></li>
  <li>State
    <p>プロセスの状態を表す。ホストのStateと同じく、DEAD,INIT,ALIVE の３つの状態があります。DEAD,INIT の場合は行が赤く表示される。<br>
    DEAD: プロセスへのコネクションが張れない(プロセスが動いていないか、ネットワークが切断している)<br>
    INIT: プロセスへのコネクションは張れているが、pingが帰って来ない(プロセスが起動しているが、止まっている、もしくは、vceのバージョンが違うとINITになる場合もある)<br>
    ALIVE: プロセスが正常に稼働している。
  </p></li>
  <li>Type
    <p>プロセスの種類。現在は、VCE を使用したプロセスである事を示す 1 しかない。</p></li>
  <li>Port
    <p>プロセスが使用しているサービスのポート。<br>
    これは、vce_tcpcontext_create関数で一番最初に作られたサーバーコンテキストのポート番号を示す。</p></li>
  <li>AdmPort
    <p>管理用のVCE-Monitorポート</p></li>
  <li>Ping
    <p>プロセスへの ping 値（単位：ミリ秒）。
    アプリケーションレベルでの ping の為、数値はアプリケーションの状態に左右される。vce_heatbeatの１回当たりの時間が長いと、この値も大きくなる。 
  </p></li>
  <li>Ping グラフ
    <p>Pingのグラフ。[ツール]-[設定]-[グラフ] で カスタマイズ可能。</p></li>
  <li>Login
    <p>VCE monitor APIを使用して得た、プロセスへの login 数。 プロセスは、get_login <a href="monitor_command.html">モニターコマンド</a>に反応するように作成されなければならない。</p></li>
  <li>Login グラフ
    <p>Loginのグラフ。[ツール]-[設定]-[グラフ] で カスタマイズ可能。</p></li>
  <li>Session
    <p>Portで示されたtcpcontextのコネクション数。</p></li>
  <li>Session グラフ
    <p>Session のグラフ。[ツール]-[設定]-[グラフ] で カスタマイズ可能。</p></li>
  <li>VCEState
    <p>未決定</p></li>
</ul>


<h3>プロセスウィンドウの操作</h3>
<p>プロセスウィンドウでは、以下の操作を行う事が出来る。 プロセスウィンドウの操作は、ウィンドウメニューの[プロセス]から、またはプロセスウィンドウ上で右クリックする事によって現れるメニューから行う。</p>
<ul> 
  <li>ウィンドウの自動更新の切り替え
    <p>ウィンドウ情報の自動更新のOn/Offを切り替える。</p></li>
  <li>ウィンドウの更新
    <p>ウィンドウ情報を更新する。</p></li>
  <li>コマンド実行
    <p><a href="monitor_command.html">モニターコマンド</a>を実行する。コマンド結果は結果ウィンドウに出力される。
    右クリックで表示されるポップアップメニューでは、 「手動コマンド実行」と、pint、netstatのメニューがある。
      各モニターコマンドは、プロセスが実行する事の出来るモニターコマンドが一覧になって表示され、選択するとダイアログにモニターコマンドが入力された状態で表示される(未実装)。手動の場合は何も入っていないダイアログが表示される。
      実行できるコマンドはVCE-admin組込み時に設定されたものである。</p></li>
<!--  <li>登録コマンド実行
    <p>登録済みのモニターコマンドを実行します(未実装)。
    よく使うモニターコマンド（引数なども含めて）をあらかじめ登録しておくと、メニューから実行する事が出来る。</p></li>-->
  <li>プロセスの起動/停止/再起動/起動ログの表示
    <p>プロセスを起動/停止/再起動する。起動、再起動は<a href="#editstartcmd">起動コマンドの設定</a>をあらかじめ行うか、admsv 
    サーバー設定ファイル(<a href="admsv.html#admsv.list">admsv.list</a>)で設定をしていなければならない。起動ログの表示 でプロセス起動の結果を確認できる。</p></li>
  <li>タグの編集
    <p>プロセスのTAGの編集をする。権限制限がある。（未実装)</p></li>
  <li>プロセスの作成／削除
    <p>プロセスの作成、削除を行う。権限制限がある。（未実装）</p></li>
  <li><a name="editstartcmd">起動コマンドの設定</a>
    <p>プロセスを起動する為の起動コマンドを設定する。これが正しく設定されていないとプロセスが起動しない。(現在未実装であるため、admsvの設定ファイルで設定を行う。)</p></li>
</ul>


<a name="srhwnd"></a>
<h2>ログ検索ウィンドウ</h2>
<p>各プロセスが生成するログをこのウィンドウから grep like に検索する事が出来る。対象ログは、<a href="vcelog.html#logformat">VCE ログフォーマット</a>
に従っているログのみである。</p>
<p><img src="search_window.png" width="418" height="328">  </p>

<h3>ウィンドウの説明</h3>
<ul> 
  <li>検索する名前
    <p>検索対象の名前（キャラ名など）を入力する。完全一致検索である。</p></li>
  <li>検索するID
    <p>検索対象のID(ユーザーIDなど)を入力する。完全一致検索である。</p></li>
  <li>検索する文字列
    <p>検索する文字列を指定する。log format の自由文字列部分を検索する。</p></li>
</ul>      
<p>名前、ID、文字列はどれか１つは指定しなければならない。</p>
<ul>
  <li>検索対象プロセス
    <p>検索対象プロセスを指定する。コンボボックスのドロップダウンリストに指定可能なプロセスが表示されているので選択する。（必須）</p></li>
  <li>Type
    <p>検索対象のlog のtypeを指定します。それぞれのプロセスで指定可能なtypeがコンボボックスのドロップダウンリストに入力されているので、それを指定してください。(必須)</p></li>
  <li>検索対象時間
    <p>Fromのみ を省略するとログの最初から、To を省略すると検索を開始した時間まで、 両方省略するとリアルタイム検索になる。</p></li>
  <li>ZIP圧縮転送＆保存
    <p>検索結果を圧縮し、ファイルに保存する。データはサーバーで圧縮され転送される。</p></li>
  <li>リアルタイム検索
    <p>これをチェックすると、検索対象時間が無視され随時検索となり、新しくログが入力されると即検索され、出力される。</p></li>
  <li>検索開始
    <p>このボタンを押すと検索を開始し、検索結果ウィンドウが開き検索結果が表示される。</p></li>
  <li>マージ
    <p>複数の検索結果のログを連結して時系列にソートし、新しいウィンドウに出力する。</p></li>
</ul>


<a name="chat"></a>
<h2>チャット関連</h2>
<p>admcliでチャットを行う為には、チャットルームという、サブジェクト毎に別れた部屋に入室して行う。チャットルームは複数入室する事ができる。</p>

<h3>チャットリストウィンドウ</h3>
<p>チャットリストウィンドウでは、チャットルームの一覧を表示しています。</p>
<ul> 
  <li>ID
    <p>部屋のID番号。部屋を識別するのに使用する。</p></li>
  <li>name
    <p>部屋の名前。その部屋で話すサブジェクトに関連した名前にすると良いだろう。</p></li>
</ul>

<h3>操作</h3>
<ul> 
  <li>チャットルームの作成
    <p>チャットルームを作成する。</p></li>
  <li>チャットルームの削除
    <p>指定したチャットルームを削除する。</p></li>
  <li>入室
    <p>指定したチャットルームに入室する。入室しないとチャットは出来ない。</p></li>
  <li>退室
    <p>指定したチャットルームから退室する。チャットウィンドウをクローズする事でも退室と同じ操作になる。</p></li>
</ul>

<h3>ニックネームについて</h3>
<p>部屋に入室する際にはニックネームが設定されていなければならない。[ツール]-[設定]-[ネットワーク] で設定します。その設定されていなければ入室時に設定ダイアログが表示されるのでニックネームを指定する。</p>

<h3>チャットウィンドウ</h3>
<p>部屋に入室すると、チャットウィンドウが開き、部屋に既に入室しているメンバーが Member ウィンドウに表示される。
chat とタイトルバーに書かれたウィンドウの上部がチャットログ表示ウィンドウ、下部が入力ウィンドウである。入力ウィンドウに発言したい分を入力し、Enter 
キーを押す事によって発言する。</p>


<a name="otherwindows"></a>
<h2>その他のウィンドウ</h2>
<h3>システムログウィンドウ</h3>
<p>admcli の動作の詳細をログしているウィンドウでである。</p>
<h3>結果ログウィンドウ</h3>
<p>ホストのUNIXコマンド実行時、プロセスの<a href="monitor_command.html">モニタコマンド</a>の実行時に、結果が表示される。</p>
<h3>検索結果ウィンドウ</h3>
<p>ログ検索の検索結果が出力される。
このウィンドウはTABまたはMDIウィンドウで、フローティングや他のウィンドウ（検索結果、マージ結果ウィンドウ以外）との連結などを行う事が出来ない。</p>
<h3>アラートログウィンドウ</h3>
<p>アラートのログが出力されます。</p>



<a name="config"></a>
<h2>設定</h2>
<p>[ツール]-[設定] メニューで表示されるダイアログにて、admcli の様々な設定を行う事が出来る。</p>

<h3>全般</h3>
<ul> 
  <li>ログウィンドウバッファ行数
    <p>システムログ、結果ログの表示行数を設定する。あまり多すぎると重くなるので注意する。デフォルトは 500。</li>
</ul>

<h3>ネットワーク</h3>
<p>接続するadmsvの情報の設定を行うことができる。[新規作成]、[削除]で名前をつけて情報を登録、削除することができる。</p>
<p><b>[新規作成]</b></p>
<ol>
  <li>新規作成ボタンを押し、設定の名前を入力する。</li>
  <li>サーバ名に設定した名前が表示されるので情報を入力し OK すると情報が保存される。</li>
</ol>
<p><b>[削除]</b></p>
<ol>
  <li>サーバ名のリストから削除する情報を選択する。</li>
  <li>削除ボタンを押す。</li>
</ol>      
<p>各項目は以下の通りである。</p>
<ul> 
  <li>ユーザーID
    <p>admsv ログイン用ユーザーID を設定する。</li>
  <li>パスワード
    <p>admsv ログイン用ユーザーID のパスワードを設定する。</li>
  <li>ニックネーム
    <p>チャットで使うニックネームを設定する。</li>
  <li>オートログイン
    <p>このチェックを ON にすると、admcli.exe 起動時に自動的にログインする。</li>
  <li>自動再接続
    <p>このチェックを ON にすると、接続が切断された場合に自動的に再接続する。</li>
  <li>admsv サーバーアドレス
    <p>admsv のサーバーアドレスを指定する。このアドレスに admcli は接続しようとする。</li>
  <li>ポート
    <p>admsv のポートを指定する。</li>
  <li>ポーリング間隔
    <p>ネットワークの処理を行う間隔。短い程処理を短い間隔で実行する。</li>
</ul>


<h3>ログ</h3>
<ul> 
  <li>システムログ保存ディレクトリ
    <p>システムログを保存するファイルを置くディレクトリを指定する。</p></li>
  <li>システムログファイル名接頭辞
    <p>システムログファイルは自動で生成されるが、その時にファイル名に付ける接頭辞(prefix)を指定する。システムログファイルは
      <pre>[システムログ保存ディレクトリ]\[接頭辞]_YYYYMMDD.txt</pre>
    という形式で出力される。</p></li>
  <li>結果ログ保存ディレクトリ
    <p>結果ログを保存するファイルを置くディレクトリを指定する。</p></li>
  <li>結果ログファイル名接頭辞
    <p>結果ログファイル名の接頭辞を指定する。結果ログも、システムログファイル名と同じ命名規則で出力される。</p></li>
  <li>アラートログ保存ディレクトリ
    <p>アラートログを保存するファイルを置くディレクトリを指定します。</p></li>
  <li>アラートログファイル名接頭辞
    <p>アラートログファイル名の接頭辞を指定する。アラートログも、システムログファイル名と同じ命名規則で出力される。</p></li>
  <li>グラフログ保存ディレクトリ
    <p>グラフのログ（データ）を保存するファイルを置くディレクトリを指定する。</p></li>
  <li>グラフログファイル名接頭辞
    <p>グラフログファイル名の接頭辞を指定する。グラフログファイルの命名規則は、
    <pre>[グラフログ保存ディレクトリ]\[接頭辞]_[identifier]_[kind]_[id]_YYYYMMDD.txt</pre>
    という形式である。例えば、ホスト情報のping値のログだと、
    <pre>graphlog/graphlog_host_ping_1_20030811.txt</pre>
    というように出力される。</p></li>
</ul>


<h3>グラフ</h3>
<ul> 
  <li>グラフ保存データ件数
    <p>グラフ１データがX軸１つに相当する。件数を変化させるとグラフのX軸の長さも変化する。</p></li>
  <li>各グラフの最低値／最大値／オート
    <p>最低値とは、グラフのY軸の下のラインの基準値である。この基準値より小さいデータは表示されない。
    最大値は、グラフのY軸の上のラインの基準値である。この基準値より大きいデータは、基準値までの長さでしか表示されない。</p></li>
</ul>


<h3>フォント</h3>
<p>ウィンドウ毎にフォントの指定が出来る。現在指定可能なウィンドウは、</p>
<ul>
  <li>ホストウィンドウ </li>
  <li>プロセスウィンドウ</li> 
  <li>ログウィンドウ</li> 
  <li>結果ウィンドウ</li> 
  <li>検索結果ウィンドウ</li> 
  <li>チャットリストウィンドウ </li>
  <li>チャットウィンドウ</li>
</ul>      
である。

<h3>アラート</h3>
<p>  アラートを設定すると、設定した条件を満たした場合に、ホストやプロセスウィンドウのアラート項目に「!」マークが出現し、行が黄色く表示される。また、アラート時に音を鳴したりアプリケーションを実行する事も出来る
</p>


<p>
<br>
<a href="../index.html">index に戻る</a>
<br></p>

<div id="footer">#COPYRIGHT#</div>


</body>
</html>
